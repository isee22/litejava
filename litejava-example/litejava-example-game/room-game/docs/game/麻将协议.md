# 麻将协议文档

本文档描述麻将游戏的通信协议。

## 1. 游戏流程

```
准备 → 发牌 → 摸牌 → 出牌 → 吃/碰/杠 → 胡
```

## 2. 命令号

| cmd | 名称 | 方向 | 说明 |
|-----|------|------|------|
| 400 | GAME_START | S→C | 游戏开始 |
| 401 | GAME_OVER | S→C | 游戏结束 |
| 410 | DEAL | S→C | 发牌 |
| 411 | DRAW | S→C | 摸牌 |
| 3001 | DISCARD | C→S | 出牌 |
| 3003 | CHI | C→S | 吃 |
| 3005 | PONG | C→S | 碰 |
| 3007 | KONG | C→S | 杠 |
| 3009 | HU | C→S | 胡 |
| 3011 | PASS | C→S | 过 |
| 3012 | ACTION_PROMPT | S→C | 操作提示 |

## 3. 牌值编码

```
牌值 = 花色 * 9 + 点数

花色: 0=万, 1=条, 2=筒
点数: 0=一, 1=二, ..., 8=九

特殊牌: 27=东, 28=南, 29=西, 30=北, 31=中, 32=发, 33=白
```

## 4. 协议详情

### 4.1 发牌 (DEAL)
```json
{
  "cmd": 410,
  "data": {
    "tiles": [0, 1, 2, 3, 9, 10, 11, 18, 19, 20, 27, 28, 31],
    "seatWind": 0
  }
}
```

### 4.2 操作提示 (ACTION_PROMPT)
```json
{
  "cmd": 3012,
  "data": {
    "tile": 5,
    "fromSeat": 0,
    "actions": ["chi", "pong", "pass"],
    "chiOptions": [[3, 4, 5], [4, 5, 6]]
  }
}
```

### 4.3 胡牌 (HU_RESULT)
```json
{
  "cmd": 3010,
  "data": {
    "seatIndex": 1,
    "tiles": [0, 0, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 9, 9],
    "huTile": 6,
    "zimo": false,
    "fan": 3,
    "fanTypes": ["清一色", "平胡"]
  }
}
```

## 5. 番种 (四川麻将)

| 番种 | 番数 | 说明 |
|------|------|------|
| 平胡 | 1 | 基本胡牌 |
| 自摸 | 1 | 自己摸到胡牌 |
| 清一色 | 4 | 全是同一花色 |
| 对对胡 | 2 | 4个刻子+1对 |
| 七对 | 4 | 7对牌 |
